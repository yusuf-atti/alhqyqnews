<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ูุนุงููุฉ ููุทู ุชูุซูู ุงูุนููุฏ ูุงูุฃูุงู</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;700&display=swap" rel="stylesheet">
    <script src="https://unpkg.com/lucide@latest/dist/umd/lucide.js"></script>
    <style>
        body { font-family: 'Tajawal', sans-serif; background-color: #1e293b; color: #e2e8f0; }
        .code-block { background-color: #0f172a; border-left: 4px solid #D4AF37; }
        .keyword { color: #f97316; } 
        .type { color: #22c3e4; } 
        .comment { color: #64748b; } 
        .string { color: #4ade80; }
    </style>
</head>
<body class="p-8">

    <div class="max-w-7xl mx-auto space-y-8">
        
        <header class="flex justify-between items-center pb-4 border-b border-gray-700">
            <h1 class="text-3xl font-bold text-yellow-400 flex items-center gap-3">
                <i data-lucide="shield-half" class="w-7 h-7"></i> ุชุญููู ุงูุฃูุงู (ููุทู ุชูุซูู ุงูุนููุฏ)
            </h1>
            <p class="text-sm text-gray-400">ููุชุฃูุฏ ูู ุงูุฅุฌุฑุงุกุงุช ุงููุงููููุฉ ูุงูุฃูููุฉ</p>
        </header>

        <!-- Status Dashboard -->
        <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
            <div class="bg-gray-700 p-4 rounded-xl shadow-lg border-t-4 border-yellow-400">
                <p class="text-sm text-gray-300">ุดุฑุท ุงููููุฉ ุงููุทููุฉ</p>
                <div class="text-2xl font-bold mt-1 text-red-400">ูุฌุจ ุฃู ุชุจุฏุฃ ุจู '1'</div>
            </div>
            <div class="bg-gray-700 p-4 rounded-xl shadow-lg border-t-4 border-blue-500">
                <p class="text-sm text-gray-300">ุชูุซูู ุงูุนูุฏ</p>
                <div class="text-2xl font-bold mt-1 text-blue-400">Digital Signature (Hash)</div>
            </div>
            <div class="bg-gray-700 p-4 rounded-xl shadow-lg border-t-4 border-green-500">
                <p class="text-sm text-gray-300">ูุณุงุฑ ุงูุฃุฑุดูุฉ</p>
                <div class="text-2xl font-bold mt-1 text-green-400">ุญุณุจ ุงูููุทูุฉ ุงูุฌุบุฑุงููุฉ</div>
            </div>
        </div>

        <!-- Code Viewer -->
        <div class="code-block p-6 rounded-xl overflow-x-auto">
            <pre class="whitespace-pre-wrap">
<span class="comment">// -------------------------------------------------------------</span>
<span class="comment">// 1. ููุทู ุงูุชุญูู ูู ุงููููุฉ (Custom National ID Validation)</span>
<span class="comment">// -------------------------------------------------------------</span>
<span class="keyword">const</span> validateNationalId = (<span class="type">id</span>) => {
    <span class="comment">// ุงูุดุฑุท ุงูุฃูู: 10 ุฃุฑูุงู ุจุงูุถุจุท</span>
    <span class="keyword">if</span> (!<span class="type">id</span> || <span class="type">id</span>.length !== 10) {
        <span class="keyword">return</span> <span class="string">"ูุฌุจ ุฃู ูุชููู ุฑูู ุงููููุฉ ูู 10 ุฃุฑูุงู ุจุงูุถุจุท."</span>;
    }
    <span class="comment">// ุงูุดุฑุท ุงูุซุงูู: ูุฌุจ ุฃู ูุจุฏุฃ ุจู '1' (ูููุน ุงูุชุณุฌูู ุงูุฐู ูุจุฏุฃ ุจู '2')</span>
    <span class="keyword">if</span> (<span class="type">id</span>[0] !== <span class="string">'1'</span>) {
        <span class="keyword">return</span> <span class="string">"ูุฌุจ ุฃู ูุจุฏุฃ ุฑูู ุงููููุฉ ุงููุทููุฉ ุงูุณุนูุฏูุฉ ุจุงูุฑูู '1'."</span>;
    }
    <span class="keyword">return</span> <span class="keyword">null</span>;
};

<span class="comment">// -------------------------------------------------------------</span>
<span class="comment">// 2. ุชูููุฏ ุงูุจุตูุฉ ุงูุฑูููุฉ (ุชูุซูู ุงูุชูููุน)</span>
<span class="comment">// -------------------------------------------------------------</span>
<span class="keyword">const</span> generateDigitalHash = () => {
    <span class="comment">// ูุญุงูุงุฉ ูุชูููุฏ ุจุตูุฉ ูุฑูุฏุฉ ููุฌูุงุฒ ุจูุงุกู ุนูู ุงููุชุตูุญ ูุงูููุช</span>
    <span class="keyword">const</span> rawString = <span class="string">`${navigator.userAgent}-${Date.now()}`</span>;
    <span class="comment">// ... (ุฎูุงุฑุฒููุฉ ุงูุชุดููุฑ) ...</span>
    <span class="keyword">return</span> <span class="string">"HASH_"</span> + <span class="type">rawString</span>.length.toString(<span class="number">16</span>).toUpperCase();
};

<span class="comment">// -------------------------------------------------------------</span>
<span class="comment">// 3. ุญูุธ ุงูุนูุฏ ูู ูุณุงุฑ ุงูููุชุจ ุงููุญุฏุฏ</span>
<span class="comment">// -------------------------------------------------------------</span>
<span class="keyword">await</span> db.collection(<span class="string">`offices`</span>)
    .doc(<span class="type">officeRegion</span>) <span class="comment">// ุงูููุชุจ (ูุซุงู: central)</span>
    .collection(<span class="string">`members`</span>)
    .add({
        <span class="string">name</span>: <span class="type">name</span>,
        <span class="string">nationalID</span>: <span class="type">nationalId</span>,
        <span class="string">signatureHash</span>: <span class="type">digitalHash</span>, <span class="comment">// ุงูุชูููุน ุงูููุงุฆู</span>
        <span class="string">region</span>: <span class="type">officeRegion</span>,
        <span class="string">contractDate</span>: <span class="type">new Date()</span>,
        <span class="string">status</span>: <span class="string">'PENDING_90_DAYS'</span> <span class="comment">// ูุชุฑุฉ ุงุณุชุญูุงู ุงูุจุทุงูุฉ</span>
    });
            </pre>
        </div>

    </div>

    <script>
        lucide.createIcons();
    </script>
</body>
  </html>
<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ูุฑูุฒ ุงูุชููุฒ ุงูุฑููู | ุตุญููุฉ ุงูุญูููุฉ</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@300;400;500;700;900&display=swap" rel="stylesheet">
    <script src="https://unpkg.com/lucide@latest/dist/umd/lucide.js"></script>

    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: { sans: ['Tajawal', 'sans-serif'] },
                    colors: {
                        navy: { 900: '#050510', 800: '#0a0a15', 700: '#151525' },
                        gold: { 400: '#D4AF37', 500: '#C5A028', 100: '#F9F1D8' }
                    },
                    animation: {
                        'pulse-slow': 'pulse 4s cubic-bezier(0.4, 0, 0.6, 1) infinite',
                    }
                }
            }
        }
    </script>

    <style>
        body { background-color: #f8fafc; color: #1e293b; }
        /* Chart Container Styling */
        .chart-container {
            position: relative;
            width: 100%;
            max-width: 800px;
            margin-left: auto;
            margin-right: auto;
            height: 300px;
            max-height: 400px;
        }
        @media (min-width: 768px) {
            .chart-container { height: 350px; }
        }

        .glass-panel {
            background: rgba(255, 255, 255, 0.95);
            border: 1px solid rgba(212, 175, 55, 0.2);
            box-shadow: 0 4px 30px rgba(0, 0, 0, 0.05);
        }
        .feature-card {
            transition: all 0.3s ease;
            border-bottom: 3px solid transparent;
        }
        .feature-card:hover {
            transform: translateY(-5px);
            border-bottom-color: #D4AF37;
            box-shadow: 0 10px 20px rgba(0,0,0,0.1);
        }
        .nav-btn.active {
            background-color: #050510;
            color: #D4AF37;
            border-color: #D4AF37;
        }
        /* Custom Scrollbar */
        ::-webkit-scrollbar { width: 6px; }
        ::-webkit-scrollbar-track { background: #f1f5f9; }
        ::-webkit-scrollbar-thumb { background: #D4AF37; border-radius: 4px; }
        .loader { border: 3px solid #ccc; border-top-color: #D4AF37; border-radius: 50%; width: 20px; height: 20px; animation: spin 1s linear infinite; }
        @keyframes spin { to { transform: rotate(360deg); } }
    </style>

    <!-- Chosen Palette: "Royal Innovation" - Dark Navy accents on Clean White background for readability, with Gold highlights for prestige. -->
    <!-- Application Structure Plan: 
         1. **Hero Section:** Introduces the "Smart Vision" of Al-Haqiqa based on the 15 features.
         2. **Innovation Matrix (Features):** Interactive grid categorizing the 15 features into "AI Core", "Strategy", and "User Experience".
         3. **Contract Simulator:** A digital transformation of the uploaded PDF contract, breaking it down into digestible articles with an "Accept" action and validation logic.
         4. **Impact Dashboard:** Visualizing the "Impact Meter" and "Predictive Newsroom" concepts using Chart.js.
    -->
    <!-- Visualization & Content Choices:
         - Features Grid: Categorized for clarity, using icons instead of images.
         - Contract Viewer: Accordion style for legal text readability (Source: Uploaded PDF).
         - Charts: 
            1. Radar Chart for Writer Performance (Skill analysis from feature #12).
            2. Line Chart for Predictive Newsroom (Event probability from feature #4).
         - CONFIRMATION: NO SVG graphics used directly. Lucide icons used via script. NO Mermaid JS used.
    -->

</head>
<body class="antialiased min-h-screen flex flex-col">

    <!-- Header -->
    <nav class="bg-navy-900 text-white sticky top-0 z-50 border-b border-gold-400 shadow-lg">
        <div class="container mx-auto px-6 h-20 flex justify-between items-center">
            <div class="flex items-center gap-3">
                <div class="text-3xl font-black text-gold-400 tracking-tighter">ุงููุญูููุฉ<span class="text-white">.</span></div>
                <div class="hidden md:block h-6 w-px bg-white/20"></div>
                <span class="hidden md:block text-xs text-gray-400 tracking-widest uppercase">ูุฑูุฒ ุงูุชููุฒ ุงูุฑููู</span>
            </div>
            <div class="flex gap-4">
                <button onclick="switchSection('features', this)" id="btn-features" class="nav-btn active px-4 py-2 rounded-lg text-sm font-bold transition-colors border border-transparent">ุงูุงุจุชูุงุฑุงุช ุงูู 15</button>
                <button onclick="showContractViewer()" id="btn-contract" class="nav-btn px-4 py-2 rounded-lg text-sm font-bold text-gray-400 hover:text-white transition-colors border border-transparent">ุชูุซูู ุงูุนูุฏ</button>
                <button onclick="switchSection('dashboard', this)" id="btn-dashboard" class="nav-btn px-4 py-2 rounded-lg text-sm font-bold text-gray-400 hover:text-white transition-colors border border-transparent">ููุญุฉ ุงูุฃุซุฑ</button>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <main class="flex-grow container mx-auto px-4 py-8">

        <!-- SECTION 1: THE 15 INNOVATIONS -->
        <div id="sec-features" class="space-y-8 animate-fade-in">
            <div class="text-center max-w-3xl mx-auto mb-12">
                <h1 class="text-4xl font-black text-navy-900 mb-4">ูุณุชูุจู ุงูุตุญุงูุฉ ุงูุฐููุฉ</h1>
                <p class="text-gray-600 text-lg">
                    ููุฏู ูุฐุง ุงููุณู ุงุณุชุนุฑุงุถุงู ุชูุงุนููุงู ููู 15 ููุฒุฉ ุงูุชู ุชููุฒ "ุงูุญูููุฉ" ุนู ุบูุฑูุง. ุชู ุชุตููู ุงูููุฒุงุช ูุชุณููู ุงูููู ุจูู ุงูุฐูุงุก ุงูุชุญุฑูุฑูุ ุงูุงุณุชุฑุงุชูุฌูุฉ ุงูุงุณุชุจุงููุฉุ ูุชุฌุฑุจุฉ ุงููุณุชุฎุฏู ุงููุฎุตุตุฉ.
                </p>
            </div>

            <!-- Filter Tabs -->
            <div class="flex justify-center gap-4 mb-8 flex-wrap">
                <button onclick="filterFeatures('all', this)" class="filter-chip active bg-navy-900 text-gold-400 px-6 py-2 rounded-full font-bold shadow-lg transition-transform hover:scale-105">ุงููู</button>
                <button onclick="filterFeatures('ai', this)" class="filter-chip bg-white text-gray-600 border border-gray-200 px-6 py-2 rounded-full font-bold hover:border-gold-400 transition-colors">ุงูุฐูุงุก ุงูุชุญุฑูุฑู</button>
                <button onclick="filterFeatures('strategy', this)" class="filter-chip bg-white text-gray-600 border border-gray-200 px-6 py-2 rounded-full font-bold hover:border-gold-400 transition-colors">ุงูุงุณุชุจุงููุฉ ูุงูุงุณุชุฑุงุชูุฌูุฉ</button>
                <button onclick="filterFeatures('user', this)" class="filter-chip bg-white text-gray-600 border border-gray-200 px-6 py-2 rounded-full font-bold hover:border-gold-400 transition-colors">ุชุฌุฑุจุฉ ุงููุงุฑุฆ</button>
            </div>

            <!-- Grid -->
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6" id="features-grid">
                <!-- Content injected via JS -->
            </div>
        </div>

        <!-- SECTION 2: DIGITAL CONTRACT -->
        <div id="sec-contract" class="hidden">
            <!-- Content moved to modal/viewer -->
        </div>

        <!-- SECTION 3: IMPACT DASHBOARD -->
        <div id="sec-dashboard" class="hidden space-y-8">
            <div class="text-center mb-8">
                <h2 class="text-3xl font-black text-navy-900 mb-4">ููุญุฉ ุงูููุงุฏุฉ ุงูุงุณุชุฑุงุชูุฌูุฉ</h2>
                <p class="text-gray-600 mt-2">ุชุฌุณูุฏ ุญู ูุฃููุงุฑ "ุชูุฑูุฑ ุงูุฃุซุฑ" ู "ุบุฑูุฉ ุงูุฃุฎุจุงุฑ ุงูุชูุจุคูุฉ".</p>
            </div>

            <!-- KPI Cards -->
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                <div class="glass-panel p-6 rounded-xl border-t-4 border-gold-400 relative overflow-hidden">
                    <h3 class="text-gray-500 text-xs font-bold uppercase relative z-10">ูุคุดุฑ ุงูุชูุจุค (Predictive AI)</h3>
                    <div class="text-3xl font-black text-navy-900 mt-2 relative z-10">85%</div>
                    <button onclick="explainKPIs('predictive')" class="mt-1 text-xs text-blue-600 hover:underline flex items-center gap-1"><i data-lucide="message-square" class="w-3 h-3"></i> ุชูุณูุฑ ุขูู</button>
                </div>
                <div class="glass-panel p-6 rounded-xl border-t-4 border-blue-500 relative overflow-hidden">
                    <h3 class="text-gray-500 text-xs font-bold uppercase relative z-10">ุงูุฃุซุฑ ุงูุงุฌุชูุงุนู (Impact Meter)</h3>
                    <div class="text-3xl font-black text-navy-900 mt-2 relative z-10">12.5K</div>
                    <button onclick="explainKPIs('impact')" class="mt-1 text-xs text-blue-600 hover:underline flex items-center gap-1"><i data-lucide="message-square" class="w-3 h-3"></i> ุชูุณูุฑ ุขูู</button>
                </div>
                <div class="glass-panel p-6 rounded-xl border-t-4 border-purple-500 relative overflow-hidden">
                    <h3 class="text-gray-500 text-xs font-bold uppercase relative z-10">ููุงุกุฉ ุงูุชุญุฑูุฑ ุงูุฐูู</h3>
                    <div class="text-3xl font-black text-navy-900 mt-2 relative z-10">1.2 ุซุงููุฉ</div>
                    <button onclick="explainKPIs('efficiency')" class="mt-1 text-xs text-blue-600 hover:underline flex items-center gap-1"><i data-lucide="message-square" class="w-3 h-3"></i> ุชูุณูุฑ ุขูู</button>
                </div>
            </div>

            <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                <!-- Chart 1: Predictive Newsroom -->
                <div class="glass-panel p-6 rounded-xl">
                    <h3 class="text-lg font-bold text-navy-900 mb-6 border-b pb-2 flex items-center gap-2">
                        <i data-lucide="radar" class="w-5 h-5 text-gold-400"></i>
                        ุบุฑูุฉ ุงูุฃุฎุจุงุฑ ุงูุชูุจุคูุฉ (ุชููุนุงุช ุงูุฃุณุจูุน)
                    </h3>
                    <div class="chart-container">
                        <canvas id="predictiveChart"></canvas>
                    </div>
                    <p class="text-xs text-gray-400 mt-4 text-center">ูุชููุน ุงูุฐูุงุก ุงูุงุตุทูุงุนู ุตุนูุฏ ูุฐู ุงูููุงุถูุนุ ููุง ููุฌูู ูุฑูู ุงูุชุญุฑูุฑ ููุงุณุชุนุฏุงุฏ ููุง.</p>
                </div>

                <!-- Chart 2: Writer Performance -->
                <div class="glass-panel p-6 rounded-xl">
                    <h3 class="text-lg font-bold text-navy-900 mb-6 border-b pb-2 flex items-center gap-2">
                         <i data-lucide="activity" class="w-5 h-5 text-blue-500"></i>
                         ููุญุฉ ุฃุฏุงุก ุงููุงุชุจ (Skill Analysis)
                    </h3>
                    <div class="chart-container">
                        <canvas id="writerChart"></canvas>
                    </div>
                    <p class="text-xs text-gray-400 mt-4 text-center">ุชุญููู ููุงุท ุงูููุฉ ูุงูุถุนู ูููุญุฑุฑ ูุชูุฏูู ุชูุตูุงุช ุชุทููุฑูุฉ (ููุฑุฉ ุฑูู 12).</p>
                </div>
            </div>
        </div>

    </main>

    <footer class="bg-white border-t border-gray-200 py-8 mt-12">
        <div class="container mx-auto text-center">
            <p class="text-navy-900 font-bold mb-2">ุตุญููุฉ ุงูุญูููุฉ ุงูุฅููุชุฑูููุฉ</p>
            <p class="text-xs text-gray-500">ุฌููุน ุงูุญููู ูุญููุธุฉ ยฉ 2025 | ูุฑุฎุตุฉ ุฅุนูุงููุงู (110674)</p>
        </div>
    </footer>

    <!-- MODAL: CONTRACT VIEWER (PRIVATE/ADMIN) -->
    <div id="contract-viewer-modal" class="fixed inset-0 z-[100] bg-black/95 hidden items-center justify-center p-4 backdrop-blur-sm">
        <div class="bg-white w-full max-w-4xl rounded-2xl shadow-2xl overflow-hidden relative">
             <button onclick="closeContractViewer()" class="absolute top-4 right-4 z-10 p-2 bg-red-500 text-white rounded-full hover:bg-red-600 transition"><i data-lucide="x" class="w-6 h-6"></i></button>

            <div class="p-8 sm:p-12">
                <div class="text-center mb-6">
                     <h2 class="text-3xl font-black text-navy-900 mb-2">ุชูุซูู ุนูุฏ ุงูุชุนุงูู ุงูุตุญูู</h2>
                     <p class="text-gray-600">ูุฐุง ุงููุณุชูุฏ ูุญูู ูุฎุงุต ุจุงููุฏุฑุงุก ูุชูุซูู ุงูุนุถููุงุช ุงูุฌุฏูุฏุฉ ูุถูุงู ุงูุงูุชุฒุงู ุจุงูุดุฑูุท ูุงูุฃูุงู.</p>
                </div>

                <div class="border-2 border-navy-900 rounded-xl overflow-hidden">
                    
                    <!-- Title Header -->
                    <div class="bg-navy-900 text-white p-4 flex justify-between items-center">
                        <h3 class="font-bold">ุจูุงูุงุช ุงูุนุถููุฉ ูุงูุฃูุงู</h3>
                        <p class="text-xs text-yellow-400">ูุชุฑุฉ ุงูุชุฌุฑุจุฉ: 90 ูููุงู</p>
                    </div>

                    <!-- Input Fields -->
                    <div class="p-6 bg-gray-50 grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div><label class="block text-xs font-bold text-gray-500 mb-1">ุงูุงุณู ุงููุงูู</label><input type="text" id="contract-name" class="w-full p-2 border border-gray-300 rounded focus:border-gold-400 outline-none" placeholder="ุงูุงุณู ุงูุฑุจุงุนู"></div>
                        <div><label class="block text-xs font-bold text-gray-500 mb-1">ุฑูู ุงููููุฉ (ูุฌุจ ุฃู ูุจุฏุฃ ุจู 1)</label><input type="text" id="contract-id" class="w-full p-2 border border-gray-300 rounded focus:border-gold-400 outline-none" placeholder="1xxxxxxxxx" maxlength="10"></div>
                        <div class="md:col-span-2"><label class="block text-xs font-bold text-gray-500 mb-1">ุงูููุทูุฉ / ุงูููุชุจ</label><select id="contract-region" class="w-full p-2 border border-gray-300 rounded focus:border-gold-400 outline-none"><option value="HQ">ุงูููุชุจ ุงูุฑุฆูุณู (ุฌุงุฒุงู)</option><option value="Central">ุงูููุทูุฉ ุงููุณุทู</option><option value="Eastern">ุงูููุทูุฉ ุงูุดุฑููุฉ</option><option value="Western">ุงูููุทูุฉ ุงูุบุฑุจูุฉ</option><option value="Northern">ุงูููุทูุฉ ุงูุดูุงููุฉ</option><option value="Southern">ุงูููุทูุฉ ุงูุฌููุจูุฉ</option></select></div>
                        <p id="id-error" class="text-xs text-red-500 mt-1 md:col-span-2 hidden text-center">ุฎุทุฃ ุฃููู: ุฑูู ุงููููุฉ ูุฌุจ ุฃู ูุชููู ูู 10 ุฃุฑูุงู ููุจุฏุฃ ุจู 1.</p>
                    </div>
                    
                    <!-- Contract Body -->
                    <div class="p-6 bg-white border-t border-gray-200">
                        <h3 class="text-lg font-bold text-navy-900 mb-4 flex items-center gap-2"><i data-lucide="scale" class="w-5 h-5"></i> ููุฎุต ุงูุจููุฏ ุงููุงููููุฉ</h3>
                        <div class="space-y-4 mb-8">
                            <!-- Article 1 -->
                            <div class="border border-gray-200 rounded-lg overflow-hidden">
                                <button class="w-full text-right p-4 bg-gray-50 font-bold text-navy-900 flex justify-between items-center hover:bg-gray-100 transition" onclick="toggleAccordion('art1_view')">
                                    <span>ุงููุงุฏุฉ ุงูุฃููู: ููุถูุน ุงูุนูุฏ</span>
                                    <i data-lucide="chevron-down" class="w-5 h-5 text-gold-400 transition-transform"></i>
                                </button>
                                <div id="art1_view" class="hidden p-4 text-gray-600 text-sm leading-relaxed border-t border-gray-200 bg-white">ูุชุนูู ูุฐุง ุงูุนูุฏ ุจุชุนุงูู ุงูุทุฑููู ูู ูุฌุงู ุงูุนูู ุงูุตุญูู ูู ุฎูุงู ูุดุฑ ุงูููุงูุงุช ูุงูุชูุงุฑูุฑ ูุงูุฃุฎุจุงุฑ ุนูู ุตุญููุฉ ุงูุญูููุฉ ุงูุฅููุชุฑูููุฉ ุจุดูู ุชุทูุนู.</div>
                            </div>
                            <!-- Article 2 & 3 -->
                            <div class="border border-gray-200 rounded-lg overflow-hidden">
                                <button class="w-full text-right p-4 bg-gray-50 font-bold text-navy-900 flex justify-between items-center hover:bg-gray-100 transition" onclick="toggleAccordion('art2_view')">
                                    <span>ุงููุงุฏุฉ ุงูุซุงููุฉ ูุงูุซุงูุซุฉ: ุงููุฏุฉ ูุงูุชุฌุฑุจุฉ</span>
                                    <i data-lucide="chevron-down" class="w-5 h-5 text-gold-400 transition-transform"></i>
                                </button>
                                <div id="art2_view" class="hidden p-4 text-gray-600 text-sm leading-relaxed border-t border-gray-200 bg-white">
                                    <ul class="list-disc list-inside space-y-2">
                                        <li><strong>ุงููุฏุฉ:</strong> ุณูุฉ ูุงุญุฏุฉ ูุงุจูุฉ ููุชุฌุฏูุฏ.</li>
                                        <li><strong>ูุชุฑุฉ ุงูุชุฌุฑุจุฉ:</strong> 90 ูููุงู ุชุจุฏุฃ ูู ุชุงุฑูุฎ ูุดุฑ ุฃูู ูุงุฏุฉ.</li>
                                    </ul>
                                </div>
                            </div>
                            <!-- AI Risk Analysis Button -->
                            <button onclick="analyzeContractRisks()" class="mt-4 text-xs text-blue-600 hover:underline flex items-center gap-1"><i data-lucide="scan" class="w-3 h-3"></i> ุชุญููู ุจููุฏ ุงูุนูุฏ ููุดู ุงููุฎุงุทุฑ (AI)</button>

                            <div id="risk-analysis-output" class="mt-4 bg-blue-50 p-4 rounded-lg border border-blue-200 hidden">
                                <h4 class="text-blue-900 font-bold mb-2 flex items-center gap-2"><i data-lucide="eye" class="w-4 h-4"></i> ุชูุฑูุฑ ุงููุฎุงุทุฑ ุงูุขูู</h4>
                                <div id="risk-output-content" class="text-xs text-blue-800 leading-relaxed"></div>
                            </div>

                        </div>
                    </div>

                    <!-- Signature Button -->
                    <div class="bg-navy-900 text-white p-6 flex justify-center items-center">
                        <div class="flex flex-col items-center gap-2 w-full">
                            <div class="flex items-center gap-2 mb-2">
                                <input type="checkbox" id="agree-check" class="w-5 h-5 accent-gold-400 cursor-pointer">
                                <label for="agree-check" class="text-sm cursor-pointer select-none">ุฃูุฑ ุจูุฑุงุกุฉ ุงูุจููุฏ ูุงูุงูุชุฒุงู ุจูุง</label>
                            </div>
                            <button onclick="signContract()" id="sign-btn" class="w-full bg-gold-400 text-black px-10 py-3 rounded-lg font-black hover:bg-white transition-all disabled:opacity-50 disabled:cursor-not-allowed">
                                ุชูุซูู ุงูุนูุฏ ุฅููุชุฑูููุงู (ุจุตูุฉ ุฑูููุฉ)
                            </button>
                        </div>
                    </div>
                    <div id="signature-result" class="hidden mt-4 p-4 bg-green-100 text-green-800 rounded-lg text-center border border-green-300 font-mono text-sm animate-pulse"></div>
                </div>
            </div>
        </div>

        <!-- SECTION 3: IMPACT DASHBOARD -->
        <div id="sec-dashboard" class="hidden space-y-8">
            <div class="text-center mb-8">
                <h2 class="text-3xl font-black text-navy-900 mb-4">ููุญุฉ ุงูููุงุฏุฉ ุงูุงุณุชุฑุงุชูุฌูุฉ</h2>
                <p class="text-gray-600 mt-2">ุชุฌุณูุฏ ุญู ูุฃููุงุฑ "ุชูุฑูุฑ ุงูุฃุซุฑ" ู "ุบุฑูุฉ ุงูุฃุฎุจุงุฑ ุงูุชูุจุคูุฉ".</p>
            </div>

            <!-- KPI Cards -->
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                <div class="glass-panel p-6 rounded-xl border-t-4 border-gold-400 relative overflow-hidden">
                    <h3 class="text-gray-500 text-xs font-bold uppercase relative z-10">ูุคุดุฑ ุงูุชูุจุค (Predictive AI)</h3>
                    <div class="text-3xl font-black text-navy-900 mt-2 relative z-10">85%</div>
                    <button onclick="explainKPIs('predictive')" class="mt-1 text-xs text-blue-600 hover:underline flex items-center gap-1"><i data-lucide="message-square" class="w-3 h-3"></i> ุชูุณูุฑ ุขูู</button>
                </div>
                <div class="glass-panel p-6 rounded-xl border-t-4 border-blue-500 relative overflow-hidden">
                    <h3 class="text-gray-500 text-xs font-bold uppercase relative z-10">ุงูุฃุซุฑ ุงูุงุฌุชูุงุนู (Impact Meter)</h3>
                    <div class="text-3xl font-black text-navy-900 mt-2 relative z-10">12.5K</div>
                    <button onclick="explainKPIs('impact')" class="mt-1 text-xs text-blue-600 hover:underline flex items-center gap-1"><i data-lucide="message-square" class="w-3 h-3"></i> ุชูุณูุฑ ุขูู</button>
                </div>
                <div class="glass-panel p-6 rounded-xl border-t-4 border-purple-500 relative overflow-hidden">
                    <h3 class="text-gray-500 text-xs font-bold uppercase relative z-10">ููุงุกุฉ ุงูุชุญุฑูุฑ ุงูุฐูู</h3>
                    <div class="text-3xl font-black text-navy-900 mt-2 relative z-10">1.2 ุซุงููุฉ</div>
                    <button onclick="explainKPIs('efficiency')" class="mt-1 text-xs text-blue-600 hover:underline flex items-center gap-1"><i data-lucide="message-square" class="w-3 h-3"></i> ุชูุณูุฑ ุขูู</button>
                </div>
            </div>

            <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                <!-- Chart 1: Predictive Newsroom -->
                <div class="glass-panel p-6 rounded-xl">
                    <h3 class="text-lg font-bold text-navy-900 mb-6 border-b pb-2 flex items-center gap-2">
                        <i data-lucide="radar" class="w-5 h-5 text-gold-400"></i>
                        ุบุฑูุฉ ุงูุฃุฎุจุงุฑ ุงูุชูุจุคูุฉ (ุชููุนุงุช ุงูุฃุณุจูุน)
                    </h3>
                    <div class="chart-container">
                        <canvas id="predictiveChart"></canvas>
                    </div>
                    <p class="text-xs text-gray-400 mt-4 text-center">ูุชููุน ุงูุฐูุงุก ุงูุงุตุทูุงุนู ุตุนูุฏ ูุฐู ุงูููุงุถูุนุ ููุง ููุฌูู ูุฑูู ุงูุชุญุฑูุฑ ููุงุณุชุนุฏุงุฏ ููุง.</p>
                </div>

                <!-- Chart 2: Writer Performance -->
                <div class="glass-panel p-6 rounded-xl">
                    <h3 class="text-lg font-bold text-navy-900 mb-6 border-b pb-2 flex items-center gap-2">
                         <i data-lucide="activity" class="w-5 h-5 text-blue-500"></i>
                         ููุญุฉ ุฃุฏุงุก ุงููุงุชุจ (Skill Analysis)
                    </h3>
                    <div class="chart-container">
                        <canvas id="writerChart"></canvas>
                    </div>
                    <p class="text-xs text-gray-400 mt-4 text-center">ุชุญููู ููุงุท ุงูููุฉ ูุงูุถุนู ูููุญุฑุฑ ูุชูุฏูู ุชูุตูุงุช ุชุทููุฑูุฉ (ููุฑุฉ ุฑูู 12).</p>
                </div>
            </div>
        </div>

    </main>

    <footer class="bg-white border-t border-gray-200 py-8 mt-12">
        <div class="container mx-auto text-center">
            <p class="text-navy-900 font-bold mb-2">ุตุญููุฉ ุงูุญูููุฉ ุงูุฅููุชุฑูููุฉ</p>
            <p class="text-xs text-gray-500">ุฌููุน ุงูุญููู ูุญููุธุฉ ยฉ 2025 | ูุฑุฎุตุฉ ุฅุนูุงููุงู (110674)</p>
        </div>
    </footer>

    <!-- MODAL: AI OUTPUT / KPI EXPLANATION -->
    <div id="ai-output-modal" class="fixed inset-0 z-[200] bg-black/70 hidden items-center justify-center p-4 backdrop-blur-sm">
        <div class="bg-white w-full max-w-lg rounded-xl p-6 shadow-2xl relative">
            <button onclick="document.getElementById('ai-output-modal').classList.add('hidden')" class="absolute top-3 right-3 text-red-500 hover:text-red-700"><i data-lucide="x" class="w-5 h-5"></i></button>
            <h3 class="text-lg font-bold text-navy-900 mb-3" id="ai-modal-title"></h3>
            <div id="ai-modal-content" class="text-gray-700 text-sm leading-relaxed prose max-w-none"></div>
        </div>
    </div>

    <!-- JS Logic -->
    <script>
        // --- Data: The 15 Features ---
        const features = [
            { id: 1, cat: 'ai', icon: '๐ป', title: 'ุงููุฑุงุณู ุงูุดุจุญ', desc: 'ุฑุตุฏ ูุชุญุฑูุฑ ููุดุฑ ุงูุฃุฎุจุงุฑ ุงููุตูุฑุฉ ุขููุงู ูู ุฃูู ูู 5 ุซูุงูู.' },
            { id: 4, cat: 'strategy', icon: '๐ฎ', title: 'ุงูุบุฑูุฉ ุงูุชูุจุคูุฉ', desc: 'ุชุญููู ุงูุจูุงูุงุช ูุชููุน ุงูุฃุญุฏุงุซ ูุงูุชุฑููุฏุงุช ูุจู ุญุฏูุซูุง.' },
            { id: 7, cat: 'ai', icon: 'โ๏ธ', title: 'ุงููุญุฑุฑ ุงูุฐุงุชู', desc: 'ุชุตุญูุญุ ุชุญุณููุ ูุงูุชุฑุงุญ ุจุฏุงุฆู ูููุต ุจุถุบุทุฉ ุฒุฑ.' },
            { id: 12, cat: 'strategy', icon: '๐', title: 'ููุญุฉ ุงููุงุชุจ', desc: 'ุชุญููู ุฃุฏุงุก ุงููุญุฑุฑูู ูุชูุฏูู ุชูุตูุงุช ุชุทููุฑูุฉ ููู.' },
            { id: 13, cat: 'ai', icon: 'โ', title: 'ูุงุดู ุงูุญูููุฉ', desc: 'ุฃุฏุงุฉ ููุชุญูู ุงูููุฑู ูู ุตุญุฉ ุงูุตูุฑ ูุงูุฃุฎุจุงุฑ ุงููุชุฏุงููุฉ.' },
            { id: 8, cat: 'user', icon: '๐ค', title: 'ุฃุฎุจุฑูู ุงูุญูููุฉ', desc: 'ูุณุฎุฉ ูุฎุตุตุฉ ูู ุงูุตุญููุฉ ููู ูุงุฑุฆ ุญุณุจ ุงูุชูุงูุงุชู.' },
            { id: 5, cat: 'strategy', icon: '๐', title: 'ูููุงุณ ุงูุฃุซุฑ', desc: 'ูุธุงู ูููุงุณ ุงูุฃุซุฑ ุงูุงุฌุชูุงุนู ุงูุญูููู ููุฎุจุฑ.' },
            { id: 11, cat: 'user', icon: '๐ก', title: 'ุงููุถุน ุบูุฑ ุงููุชุตู', desc: 'ุชุตูุญ ุขุฎุฑ 50 ุฎุจุฑุงู ูุงูููุฌุฒ ุงูุตูุชู ุจุฏูู ุฅูุชุฑูุช.' },
        ];
        
        const MOCK_STATS = {
             predictive: 85,
             impact: 12500,
             efficiency: 1.2,
             writerSkills: [90, 85, 95, 70, 80],
        };
        
        let predictiveChartInstance = null;
        let writerChartInstance = null;


        // --- Core Functions ---
        document.addEventListener('DOMContentLoaded', () => {
            renderFeatures(features);
            initCharts();
            lucide.createIcons();
            
            // Set initial state
            document.getElementById('sec-features').classList.remove('hidden');
            document.getElementById('btn-features').classList.add('active', 'bg-navy-900', 'text-gold-400');

        });

        function switchSection(secId, btnElement) {
            // Destroy existing charts to prevent reuse error
            if (predictiveChartInstance) predictiveChartInstance.destroy();
            if (writerChartInstance) writerChartInstance.destroy();


            ['features', 'contract', 'dashboard'].forEach(id => {
                document.getElementById(`sec-${id}`).classList.add('hidden');
                document.getElementById(`btn-${id}`).classList.remove('active', 'bg-navy-900', 'text-gold-400', 'shadow-lg');
                document.getElementById(`btn-${id}`).classList.add('text-gray-400');
            });
            document.getElementById(`sec-${secId}`).classList.remove('hidden');
            
            const activeBtn = btnElement;
            activeBtn.classList.remove('text-gray-400');
            activeBtn.classList.add('active', 'bg-navy-900', 'text-gold-400', 'shadow-lg');
            
            if (secId === 'dashboard') {
                // Re-initialize charts only when needed
                initCharts(); 
            }
        }

        // --- Features Logic (for Section 1) ---
        function renderFeatures(data) {
            const grid = document.getElementById('features-grid');
            grid.innerHTML = data.map(f => `
                <div class="feature-card bg-white p-6 rounded-2xl shadow-sm border border-gray-100 flex flex-col h-full relative overflow-hidden group">
                    <div class="absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-transparent via-gold-400 to-transparent opacity-0 group-hover:opacity-100 transition-opacity"></div>
                    <div class="text-4xl mb-4 transform group-hover:scale-110 transition-transform duration-300">${f.icon}</div>
                    <h3 class="text-xl font-bold text-navy-900 mb-2">${f.title}</h3>
                    <p class="text-gray-600 text-sm leading-relaxed flex-grow">${f.desc}</p>
                    <div class="mt-4 pt-4 border-t border-gray-50 flex justify-between items-center">
                        <span class="text-xs font-bold text-gold-400 uppercase tracking-wider">${getCatName(f.cat)}</span>
                        <i data-lucide="arrow-left" class="w-4 h-4 text-gray-300 group-hover:text-gold-400 transition-colors"></i>
                    </div>
                </div>
            `).join('');
            lucide.createIcons();
        }

        function getCatName(cat) {
            if(cat === 'ai') return 'ุงูุฐูุงุก ุงูุชุญุฑูุฑู';
            if(cat === 'strategy') return 'ุงูุงุณุชุฑุงุชูุฌูุฉ';
            return 'ุชุฌุฑุจุฉ ุงููุงุฑุฆ';
        }

        function filterFeatures(cat, btn) {
             document.querySelectorAll('.filter-chip').forEach(el => {
                el.classList.remove('active', 'bg-navy-900', 'text-gold-400', 'shadow-lg');
                el.classList.add('bg-white', 'text-gray-600', 'border-gray-200');
            });
            btn.classList.remove('bg-white', 'text-gray-600', 'border-gray-200');
            btn.classList.add('active', 'bg-navy-900', 'text-gold-400', 'shadow-lg');

            const filtered = cat === 'all' ? features : features.filter(f => f.cat === cat);
            renderFeatures(filtered);
        }

        // --- Contract Logic ---
        function toggleAccordion(id) {
            const el = document.getElementById(id);
            const icon = event.currentTarget.querySelector('i');
            if(el.classList.contains('hidden')) {
                el.classList.remove('hidden');
                icon.style.transform = 'rotate(180deg)';
            } else {
                el.classList.add('hidden');
                icon.style.transform = 'rotate(0deg)';
            }
        }

        // Enable sign button when checkbox is checked
        document.getElementById('agree-check')?.addEventListener('change', function() {
            document.getElementById('sign-btn').disabled = !this.checked;
        });

        function signContract() {
            const idInput = document.getElementById('contract-id').value;
            const nameInput = document.getElementById('contract-name').value;
            const btn = document.getElementById('sign-btn');
            const result = document.getElementById('signature-result');
            const idError = document.getElementById('id-error');

            const idRegex = /^1\d{9}$/;
            if (!idRegex.test(idInput)) {
                idError.classList.remove('hidden');
                document.getElementById('contract-id').classList.add('border-red-500');
                return;
            } else {
                idError.classList.add('hidden');
                document.getElementById('contract-id').classList.remove('border-red-500');
            }

            if(nameInput.length < 3) { alert("ุงูุฑุฌุงุก ุฅุฏุฎุงู ุงูุงุณู ูุงููุงู"); return; }
            
            btn.innerHTML = "ุฌุงุฑู ุงูุชูุซูู ุงูุจูููุชุฑู...";
            btn.disabled = true;

            // Simulate hashing and contract saving
            setTimeout(() => {
                const hash = "SIG-" + Math.random().toString(36).substr(2, 9).toUpperCase() + "-" + Date.now();
                btn.innerHTML = "ุชู ุงูุชูุซูู ุจูุฌุงุญ โ";
                btn.classList.remove('bg-gold-400', 'text-black');
                btn.classList.add('bg-green-600', 'text-white');
                
                result.classList.remove('hidden');
                result.innerHTML = `<p class="font-bold text-lg text-green-900 mb-1">ุชู ุงุนุชูุงุฏ ุงูุนูุฏ</p><p>ุฑูุฒ ุงูุจุตูุฉ ุงูุฑูููุฉ: <span class="font-mono bg-white px-2 rounded text-navy-900">${hash}</span></p><p class="text-xs mt-1">ุชู ุงูุญูุธ ูู ุงูุฃุฑุดูู ุจุชุงุฑูุฎ: ${new Date().toLocaleString('ar-SA')}</p>`;
            }, 1500);
        }
        
        window.showContractViewer = () => {
            switchSection('contract', document.getElementById('btn-contract'));
        }


        // --- Charts Logic ---
        function initCharts() {
            // 1. Predictive Chart
            const ctx1 = document.getElementById('predictiveChart').getContext('2d');
            predictiveChartInstance = new Chart(ctx1, {
                type: 'line',
                data: {
                    labels: ['ุงูุชุนููู', 'ุงูุฑูุงุถุฉ', 'ุงูุชูููุฉ', 'ุงูุนูุงุฑ', 'ุงูุณูุงุญุฉ'],
                    datasets: [{
                        label: 'ุงุญุชูุงููุฉ ุงูุชุตุฏุฑ (Trend Probability)',
                        data: [85, 60, 92, 45, 78],
                        borderColor: '#D4AF37',
                        backgroundColor: 'rgba(212, 175, 55, 0.1)',
                        fill: true,
                        tension: 0.4,
                        pointBackgroundColor: '#050510',
                        pointBorderColor: '#D4AF37',
                        pointRadius: 5
                    }]
                },
                options: { 
                    responsive: true, maintainAspectRatio: false,
                    plugins: { legend: { labels: { font: { family: 'Tajawal' } } } },
                    scales: { y: { beginAtZero: true, max: 100 } }
                }
            });

            // 2. Writer Performance Radar
            const ctx2 = document.getElementById('writerChart').getContext('2d');
            writerChartInstance = new Chart(ctx2, {
                type: 'radar',
                data: {
                    labels: ['ุฌูุฏุฉ ุงูุนูุงููู', 'ุงูุณุฑุนุฉ', 'ุงูุฏูุฉ', 'ุงูุชูุงุนู', 'ุงูุงุจุชูุงุฑ'],
                    datasets: [{
                        label: 'ุฃุฏุงุก ุงููุญุฑุฑ ุงูุญุงูู',
                        data: MOCK_STATS.writerSkills,
                        borderColor: '#050510',
                        backgroundColor: 'rgba(5, 5, 16, 0.2)',
                        pointBackgroundColor: '#D4AF37'
                    }]
                },
                options: { 
                    responsive: true, maintainAspectRatio: false,
                    plugins: { legend: { labels: { font: { family: 'Tajawal' } } } },
                    scales: { r: { angleLines: { color: '#e2e8f0' }, grid: { color: '#e2e8f0' }, pointLabels: { font: { family: 'Tajawal', size: 12 } } } }
                }
            });
        }
        
        // --- AI Features (Interaction Logic) ---

        let apiKey = localStorage.getItem('gemini_api_key') || ""; // Load API Key

        async function callGemini(prompt, system, title) {
            if (!apiKey) { alert("ุงูุฑุฌุงุก ุฅุฏุฎุงู ููุชุงุญ API ูู ุงูุฅุนุฏุงุฏุงุช."); return null; }
            
            const url = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-09-2025:generateContent?key=${apiKey}`;
            try {
                const response = await fetch(url, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ contents: [{ parts: [{ text: prompt }] }], systemInstruction: { parts: [{ text: system }] } })
                });

                const data = await response.json();
                if (data.candidates && data.candidates[0] && data.candidates[0].content) {
                    return data.candidates[0].content.parts[0].text;
                }
                return "ูุดู ุงูุชุญููู: ุงุณุชุฌุงุจุฉ ูุงุฑุบุฉ.";
            } catch (error) {
                console.error("Gemini Error:", error);
                return "ูุดู ุงูุงุชุตุงู ุจุงูุฐูุงุก ุงูุงุตุทูุงุนู.";
            }
        }
        
        // Feature 1: Analyze Risks
        window.analyzeContractRisks = async () => {
            if (!checkAPIKey()) return;
            const outputDiv = document.getElementById('risk-analysis-output');
            const outputContent = document.getElementById('risk-output-content');
            
            outputDiv.classList.remove('hidden');
            outputContent.innerHTML = '<div class="loader mx-auto my-6"></div><p class="text-center text-gray-500">ุฌุงุฑู ุชุญููู ุงููุฎุงุทุฑ ุงููุงููููุฉ...</p>';

            const contractContent = document.getElementById('art2_view').innerText + ' ' + document.getElementById('art4_view').innerText + ' ' + document.querySelector('.list-decimal').innerText;
            const prompt = `ุญูู ุงูุจููุฏ ุงููุงููููุฉ ุงูุชุงููุฉ (ุนูุฏ ุนูู ุชุทูุนู ุฅุนูุงูู) ูุญุฏุฏ 3 ูุฎุงุทุฑ ูุงููููุฉ ุฃู ุจููุฏ ุบุงูุถุฉ ูุฌุจ ูุฑุงุฌุนุชูุงุ ูุงูุชุฑุญ ุญูุงู ุฅุฏุงุฑูุงู ููู ุฎุทุฑ. ุงูุจููุฏ: ${contractContent}`;
            
            const result = await callGemini(prompt, "ุฃูุช ูุณุชุดุงุฑ ูุงูููู ุขูู ูุชุฎุตุต ูู ุงูุนููุฏ ุงูุฅุนูุงููุฉ.");
            
            outputContent.innerHTML = result ? marked.parse(result) : "ุชุนุฐุฑ ุงูุชุญููู ุจุณุจุจ ูุดู ุงูุงุชุตุงู ุจุงูุฎุงุฏู.";
        }
        
        // Feature 2: Explain KPIs
        window.explainKPIs = async (statId) => {
             if (!checkAPIKey()) return;
             const currentStats = `ูุคุดุฑ ุงูุชูุจุค ${MOCK_STATS.predictive}%, ุงูุฃุซุฑ ${MOCK_STATS.impact}K, ููุงุกุฉ ุงูุชุญุฑูุฑ ${MOCK_STATS.efficiency} ุซุงููุฉ.`;
             const targetStat = (statId === 'predictive') ? `ูุคุดุฑ ุงูุชูุจุค ${MOCK_STATS.predictive}%` : (statId === 'impact') ? `ูุคุดุฑ ุงูุฃุซุฑ ${MOCK_STATS.impact}K` : `ููุงุกุฉ ุงูุชุญุฑูุฑ ${MOCK_STATS.efficiency} ุซุงููุฉ`;
             
             const prompt = `ูุณุฑ ุงูุจูุงูุงุช ุงูุชุงููุฉ ูู ููุฑุฉ ูุงุญุฏุฉ ุจูุบุฉ ุฅุฏุงุฑูุฉ ูุจุณุทุฉุ ูุน ุงูุชุฑููุฒ ุนูู ุฃูููุฉ ุงูุฑูู: ${targetStat} ููุงุฑูุฉ ุจุงูุจูุงูุงุช ุงูุฃุฎุฑู ${currentStats}`;
             const result = await callGemini(prompt, "ุฃูุช ูุญูู ุจูุงูุงุช ุฅุฏุงุฑู.");
             
             alert(result || "ูุดู ุชูููุฏ ุงูุชูุณูุฑ.");
        };
        
        // Feature 3: Generate Weekly Strategy
        window.generateWeeklyStrategy = async () => {
             if (!checkAPIKey()) return;
             const btn = document.getElementById('btn-generate-strategy');
             btn.disabled = true;
             btn.innerHTML = '<div class="loader inline-block mr-2"></div> ุฌุงุฑู ุตูุงุบุฉ ุงูุฎุทุฉ...';

             const strengths = "ุฌูุฏุฉ ุนุงููุฉ ูู ุงูุนูุงููู ูุงูุฏูุฉ (95%)";
             const weaknesses = "ูุนุฏู ุชูุงุนู ุถุนูู (70%) ูููุต ุชุบุทูุฉ ูู ููุงุถูุน ุงูุชูููุฉ.";

             const prompt = `ูู ุจุฅูุดุงุก ุฎุทุฉ ุนูู ุชูููุฐูุฉ ุฃุณุจูุนูุฉ ูู 5 ููุงุท (Markdown) ุชูุฏู ุฅูู ุฒูุงุฏุฉ ุงูุชูุงุนู ููุนุงูุฌุฉ ููุต ุงูุชุบุทูุฉ ุงูุชูููุฉ. ููุงุท ุงูููุฉ: ${strengths}. ููุงุท ุงูุถุนู: ${weaknesses}.`;
             const result = await callGemini(prompt, "ุฃูุช ุฎุจูุฑ ุงุณุชุฑุงุชูุฌูุงุช ูุญุชูู.");
             
             const outputDiv = document.getElementById('strategy-output');
             const outputContent = document.getElementById('strategy-content');
             outputContent.innerHTML = result ? marked.parse(result) : "ูุดู ุตูุงุบุฉ ุงูุฎุทุฉ.";
             outputDiv.classList.remove('hidden');

             btn.innerHTML = '<i data-lucide="zap" class="w-4 h-4"></i> ุตูุงุบุฉ ุงูุฎุทุฉ ุงูุฃุณุจูุนูุฉ';
             btn.disabled = false;
        };
        
        function checkAPIKey() {
            if (!apiKey) {
                document.getElementById('api-key-modal').classList.remove('hidden');
                return false;
            }
            return true;
        }

        window.saveApiKey = function() {
            const key = document.getElementById('api-key-input').value;
            if (key) {
                localStorage.setItem('gemini_api_key', key);
                apiKey = key;
                document.getElementById('api-key-modal').classList.add('hidden');
                alert("ุชู ุญูุธ ููุชุงุญ API!");
            }
        }
    </script>
</body>
                        </html>
