<script>
    // ... (بقية الكود والإعدادات في ملف index.html) ...

    // يجب تعديل هذا المسار ليطابق مسار التوجيه (Routing) الفعلي في خادم PHP لديك
    // نفترض أن المسار إلى Controller هو /api/hr/
    const API_BASE_URL = '/api/hr/'; 

    // ... (بقية الدوال) ...
    
    // ====================================================================
    // تصحيح: دالة توليد الرابط ترسل الآن طلب إلى HRController
    // ====================================================================
    window.generateInviteLink = async () => {
        const inviteBox = document.getElementById('invite-box');
        const inviteLinkInput = document.getElementById('invite-link-val');
        const btn = document.querySelector('#sec-hr button'); // الزر في قسم HR
        const originalText = btn.innerHTML;
        
        btn.innerHTML = '<div class="loader ml-2"></div> جاري التوليد...'; // عرض شاشة التحميل
        btn.disabled = true;

        try {
            // إرسال طلب جلب (GET) إلى دالة generateInvite في HRController.php
            const response = await fetch(API_BASE_URL + 'generate-invite');
            const data = await response.json();

            if (data.success) {
                // عرض الرابط وكلمة المرور المؤقتة المستلمة من الخادم
                inviteLinkInput.value = data.link;
                
                // يجب أن تكون لديك عنصر لعرض كلمة المرور المؤقتة في الـ HTML
                // (أضف <p id="temp-password-display">... للمعاينة إذا لم يكن موجوداً)
                // مثال: document.getElementById('temp-password-display').innerText = `كلمة المرور: ${data.temp_password}`;
                
                inviteBox.classList.remove('hidden');
                showToast("تم توليد الرابط بنجاح. كلمة المرور: " + data.temp_password);
            } else {
                showToast(data.message || "فشل توليد الرابط (خطأ من الخادم).", true);
            }

        } catch (error) {
            console.error('Error generating invite link:', error);
            showToast("خطأ في الاتصال بالخادم. تأكد من إعداد التوجيه (Routing).", true);
        } finally {
            btn.innerHTML = originalText;
            btn.disabled = false;
        }
    }
    
    // ... (بقية الأكواد) ...
</script>
