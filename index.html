<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
    <title>ุตุญููุฉ ุงูุญูููุฉ | ุตูุช ุงููุงูุน</title>

    <link rel="manifest" href="manifest.json" />
    <meta name="theme-color" content="#050510">
    <meta name="apple-mobile-web-app-capable" content="yes">

    <!-- Styles & Fonts -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@300;400;500;700;900&display=swap" rel="stylesheet">
    <script src="https://unpkg.com/lucide@latest/dist/umd/lucide.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <!-- Firebase SDKs -->
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>

    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: { sans: ['Tajawal', 'sans-serif'] },
                    colors: { navy: { 900: '#050510', 800: '#0a0a15', 700: '#151525' }, gold: { 400: '#D4AF37', 500: '#C5A028' } },
                    animation: { 'pulse-slow': 'pulse 3s ease infinite', 'marquee': 'marquee 25s linear infinite' },
                    keyframes: { marquee: { '0%': { transform: 'translateX(100%)' }, '100%': { transform: 'translateX(-100%)' } } }
                }
            }
        }
    </script>
    <style>
        body { background-color: #050510; color: #f3f4f6; -webkit-tap-highlight-color: transparent; overflow-x: hidden; }
        .glass-nav { background: rgba(5, 5, 16, 0.95); backdrop-filter: blur(16px); border-bottom: 1px solid rgba(255, 255, 255, 0.05); }
        .glass-panel { background: rgba(21, 21, 37, 0.9); border: 1px solid rgba(255, 255, 255, 0.05); }
        .loader { border: 3px solid rgba(255,255,255,0.1); border-left-color: #D4AF37; width: 24px; height: 24px; border-radius: 50%; animation: spin 1s linear infinite; }
        .view-hidden { display: none !important; }
        .social-btn { transition: all 0.3s ease; }
        .social-btn:hover { transform: translateY(-2px); filter: brightness(1.2); }
    </style>
</head>
<body class="antialiased selection:bg-gold-400 selection:text-black pb-20 md:pb-0">

    <!-- 1. ูุงุฌูุฉ ุงูุฒูุงุฑ (Public View) -->
    <div id="public-view" class="view-visible">
        <nav class="fixed w-full z-40 glass-nav top-0">
            <div class="container mx-auto px-4 h-16 flex justify-between items-center">
                <div class="flex flex-col justify-center cursor-pointer" onclick="window.location.reload()">
                    <div class="text-2xl font-black text-gold-400 tracking-tighter leading-none">ุงููุญูููุฉ<span class="text-white">.</span></div>
                    <span class="text-[9px] text-gray-400 tracking-wider mt-0.5 font-bold">ุชุตููู: ููุณู ุงูุนุชู</span>
                </div>
                
                <div class="flex gap-2 items-center">
                    <!-- ุฒุฑ ุงูุตูุญุฉ ุงูุฑุฆูุณูุฉ -->
                    <button onclick="window.location.reload()" class="text-gray-400 hover:text-white p-2 rounded-full" title="ุงูุฑุฆูุณูุฉ">
                        <i data-lucide="home" class="w-5 h-5"></i>
                    </button>

                    <!-- ุฒุฑ ุชุณุฌูู ุงูุฏุฎูู ููุฃุนุถุงุก -->
                    <button onclick="toggleAuthModal('login')" class="bg-white/10 text-white px-3 py-1.5 rounded-lg text-xs font-bold flex items-center gap-2 hover:bg-gold-400 hover:text-black transition border border-white/5">
                        <i data-lucide="user" class="w-4 h-4"></i> <span class="hidden md:inline">ุฏุฎูู ุงูุฃุนุถุงุก</span>
                    </button>
                    
                    <!-- ุฒุฑ ุงูุชุณุฌูู ุงูุฌุฏูุฏ -->
                    <button onclick="toggleAuthModal('register')" class="bg-gold-400 text-black px-3 py-1.5 rounded-lg text-xs font-bold flex items-center gap-2 hover:bg-white transition shadow-lg">
                        <i data-lucide="user-plus" class="w-4 h-4"></i> <span class="hidden md:inline">ุนุถููุฉ ุฌุฏูุฏุฉ</span>
                    </button>
                </div>
            </div>
        </nav>

        <!-- ุดุฑูุท ุงูุฃุฎุจุงุฑ -->
        <div class="fixed top-16 w-full z-30 bg-navy-900 border-b border-white/5 py-1.5 shadow-md">
            <div class="container mx-auto px-4 flex items-center">
                <span class="text-gold-400 text-[10px] font-bold ml-3 border-l border-gray-700 px-2 whitespace-nowrap flex items-center gap-1"><div class="w-1.5 h-1.5 bg-red-500 rounded-full animate-pulse"></div> ุนุงุฌู</span>
                <div class="w-full overflow-hidden relative h-5">
                    <div id="ticker-content" class="absolute whitespace-nowrap animate-marquee text-[10px] text-gray-300 font-medium pt-0.5">
                        ุงูุญูููุฉ | ุฃูู ุตุญููุฉ ุณุนูุฏูุฉ ุฑูููุฉ ุฐููุฉ | ุชุตููู ูุฅุดุฑุงู: ููุณู ุงูุนุชู ... ุฌุงุฑู ุงูุชุญููู...
                    </div>
                </div>
            </div>
        </div>

        <!-- ุงููุญุชูู ุงูุฑุฆูุณู -->
        <main class="pt-32 container mx-auto px-4 min-h-screen">
            <section class="grid grid-cols-1 lg:grid-cols-12 gap-6 mb-10" id="hero-section">
                <div class="lg:col-span-12 flex flex-col items-center justify-center h-64 gap-4 border border-white/5 rounded-2xl bg-white/5 animate-pulse"><div class="loader"></div></div>
            </section>
            <section class="grid grid-cols-1 lg:grid-cols-12 gap-8">
                <div class="lg:col-span-8" id="news-container"><div class="space-y-4"><div class="h-28 bg-white/5 rounded-xl animate-pulse"></div></div></div>
                <div class="lg:col-span-4 hidden lg:block sticky top-36 h-fit">
                    <div class="bg-navy-800/50 p-6 rounded-2xl border border-white/5 shadow-xl">
                        <h3 class="text-gold-400 font-bold mb-4 flex items-center gap-2 border-b border-white/5 pb-2"><i data-lucide="trending-up" class="w-4 h-4"></i> ุงูุฃูุซุฑ ูุฑุงุกุฉ</h3>
                        <div id="sidebar-content" class="space-y-3"></div>
                    </div>
                </div>
            </section>
        </main>
    </div>

    <!-- 2. ุจูุงุจุฉ ุงูุฏุฎูู ูุงูุชุณุฌูู (Auth Modal) -->
    <div id="auth-modal" class="view-hidden fixed inset-0 z-[60] bg-[#050510]/95 backdrop-blur-sm flex items-center justify-center p-4 overflow-y-auto">
        <div class="glass-panel w-full max-w-md rounded-3xl p-8 relative border border-gold-400/20 shadow-2xl">
            <button onclick="toggleAuthModal()" class="absolute top-4 left-4 text-gray-400 hover:text-white"><i data-lucide="x"></i></button>
            
            <!-- Tabs -->
            <div class="flex justify-center gap-6 mb-8 border-b border-white/10 pb-2">
                <button onclick="switchAuthTab('login')" id="tab-login" class="text-gold-400 font-bold text-lg border-b-2 border-gold-400 pb-2">ุฏุฎูู</button>
                <button onclick="switchAuthTab('register')" id="tab-register" class="text-gray-500 hover:text-white pb-2 transition">ุชุณุฌูู ุฌุฏูุฏ</button>
            </div>

            <!-- Login Form -->
            <div id="form-login" class="space-y-5">
                <h2 class="text-2xl font-black text-white text-center mb-2">ุฃููุงู ุจุนูุฏุชู</h2>
                <p class="text-center text-xs text-gray-500 mb-6">ุณุฌู ุงูุฏุฎูู ูููุตูู ุฅูู ููุญุฉ ุงูุชุญูู</p>
                
                <!-- Social Login -->
                <div class="flex gap-3 justify-center mb-6">
                    <button onclick="socialLogin('google')" class="social-btn flex items-center gap-2 bg-white text-black px-4 py-2 rounded-lg font-bold text-xs shadow-lg w-full justify-center">
                        <img src="https://www.svgrepo.com/show/475656/google-color.svg" class="w-4 h-4"> ุฌูุฌู
                    </button>
                    <!-- ูููู ุฅุถุงูุฉ ุชููุชุฑ ูููุณุจูู ููุง ูุณุชูุจูุงู -->
                </div>

                <div class="relative flex items-center justify-center mb-6">
                    <div class="border-t border-white/10 w-full absolute"></div>
                    <span class="bg-[#161624] px-2 text-[10px] text-gray-500 relative z-10">ุฃู ุจุงูุจุฑูุฏ ุงูุฅููุชุฑููู</span>
                </div>

                <form onsubmit="handleLogin(event)">
                    <input type="email" id="login-email" placeholder="ุงูุจุฑูุฏ ุงูุฅููุชุฑููู" class="w-full bg-[#0a0a15] border border-white/10 rounded-xl p-3 text-white focus:border-gold-400 outline-none mb-3 transition">
                    <input type="password" id="login-password" placeholder="ูููุฉ ุงููุฑูุฑ" class="w-full bg-[#0a0a15] border border-white/10 rounded-xl p-3 text-white focus:border-gold-400 outline-none mb-4 transition">
                    <button class="w-full bg-gold-400 text-black font-bold py-3 rounded-xl hover:bg-white transition shadow-lg">ุฏุฎูู</button>
                </form>
            </div>

            <!-- Register Form (With Contract) -->
            <div id="form-register" class="space-y-5 hidden">
                <h2 class="text-2xl font-black text-white text-center mb-2">ุงูุถู ููุฑูู ุงูุญูููุฉ</h2>
                <p class="text-center text-xs text-gray-500 mb-6">ุฎุทูุชู ุงูุฃููู ูุญู ุงูุตุญุงูุฉ ุงูุฐููุฉ</p>
                
                <form onsubmit="handleRegister(event)">
                    <div class="grid grid-cols-2 gap-3 mb-3">
                        <input type="text" id="reg-name" placeholder="ุงูุงุณู ุงููุงูู" class="bg-[#0a0a15] border border-white/10 rounded-xl p-3 text-white text-xs focus:border-gold-400 outline-none">
                        <input type="text" id="reg-id" placeholder="ุฑูู ุงููููุฉ (ูุจุฏุฃ ุจู 1)" maxlength="10" class="bg-[#0a0a15] border border-white/10 rounded-xl p-3 text-white text-xs focus:border-gold-400 outline-none">
                    </div>
                    <select id="reg-region" class="w-full bg-[#0a0a15] border border-white/10 rounded-xl p-3 text-white text-xs mb-3 focus:border-gold-400 outline-none">
                        <option value="" disabled selected>ุงุฎุชุฑ ุงูููุทูุฉ / ุงูููุชุจ</option>
                        <option value="Central">ุงูููุทูุฉ ุงููุณุทู</option>
                        <option value="Eastern">ุงูููุทูุฉ ุงูุดุฑููุฉ</option>
                        <option value="Western">ุงูููุทูุฉ ุงูุบุฑุจูุฉ</option>
                    </select>
                    <input type="email" id="reg-email" placeholder="ุงูุจุฑูุฏ ุงูุฅููุชุฑููู" class="w-full bg-[#0a0a15] border border-white/10 rounded-xl p-3 text-white text-xs focus:border-gold-400 outline-none mb-3">
                    <input type="password" id="reg-password" placeholder="ูููุฉ ุงููุฑูุฑ" class="w-full bg-[#0a0a15] border border-white/10 rounded-xl p-3 text-white text-xs focus:border-gold-400 outline-none mb-3">
                    
                    <div class="bg-white/5 p-3 rounded-lg text-[10px] text-gray-400 mb-4 border border-white/5">
                        ุจุงูุชุณุฌููุ ุฃูุช ุชูุงูู ุนูู <strong class="text-gold-400">ุนูุฏ ุงูุชุนุงูู ุงูุตุญูู</strong> ููุชุฑุฉ ุงูุชุฌุฑุจุฉ (90 ูููุงู) ูุชูุชุฒู ุจุญุตุฑูุฉ ุงููุดุฑ.
                    </div>

                    <button class="w-full bg-gold-400 text-black font-bold py-3 rounded-xl hover:bg-white transition shadow-lg flex justify-center items-center gap-2">
                        <i data-lucide="fingerprint" class="w-4 h-4"></i> ุชูุซูู ูุชุณุฌูู
                    </button>
                </form>
            </div>
        </div>
    </div>

    <!-- 3. ุบุฑูุฉ ุงูููุงุฏุฉ (Admin Dashboard) -->
    <div id="dashboard-view" class="view-hidden fixed inset-0 z-[50] bg-[#050510] overflow-y-auto">
        <div class="flex min-h-screen flex-col lg:flex-row">
            <!-- Sidebar -->
            <aside class="w-full lg:w-64 bg-navy-900 border-l border-white/5 flex flex-col">
                <div class="h-16 flex items-center justify-between px-6 border-b border-white/5">
                    <h2 class="text-lg font-bold text-white">ุบุฑูุฉ ุงูุนูููุงุช</h2>
                    <button onclick="toggleDashboard()" class="lg:hidden text-gray-400"><i data-lucide="x"></i></button>
                </div>
                <div class="flex-1 p-4 space-y-2">
                    <div class="bg-white/5 p-3 rounded-lg mb-4 flex items-center gap-3">
                        <img src="https://api.dicebear.com/7.x/avataaars/svg?seed=Admin" class="w-10 h-10 rounded-full border border-gold-400">
                        <div>
                            <p class="text-white text-xs font-bold" id="dash-user-name">ุงููุณุชุฎุฏู</p>
                            <p class="text-green-500 text-[10px]">ูุชุตู ุงูุขู</p>
                        </div>
                    </div>
                    <button class="sidebar-link w-full flex items-center gap-3 px-4 py-3 bg-gold-400 text-black rounded-lg text-sm font-bold"><i data-lucide="pen-tool" class="w-4 h-4"></i> ุงููุญุฑุฑ ุงูุฐูู</button>
                    <button class="sidebar-link w-full flex items-center gap-3 px-4 py-3 text-gray-400 hover:bg-white/5 rounded-lg text-sm transition"><i data-lucide="file-text" class="w-4 h-4"></i> ุงูุฃุฑุดูู</button>
                    <button class="sidebar-link w-full flex items-center gap-3 px-4 py-3 text-gray-400 hover:bg-white/5 rounded-lg text-sm transition"><i data-lucide="users" class="w-4 h-4"></i> ุงูุฃุนุถุงุก</button>
                </div>
                <div class="p-4">
                    <button onclick="logout()" class="w-full bg-red-500/10 text-red-500 py-2 rounded-lg text-xs hover:bg-red-500 hover:text-white transition">ุชุณุฌูู ุฎุฑูุฌ</button>
                    <button onclick="toggleDashboard()" class="w-full mt-2 text-gray-500 hover:text-white text-xs">ุงูุนูุฏุฉ ูููููุน</button>
                </div>
            </aside>

            <!-- Workspace -->
            <div class="flex-1 p-6 bg-[#020205]">
                <div class="max-w-4xl mx-auto space-y-6">
                    <!-- Editor -->
                    <div class="glass-panel p-6 rounded-2xl">
                        <h3 class="text-white font-bold mb-4 text-lg">ูุดุฑ ุฎุจุฑ ุฌุฏูุฏ</h3>
                        <input type="text" id="news-title" placeholder="ุงูุนููุงู ุงูุฑุฆูุณู..." class="w-full bg-transparent text-3xl font-black text-white border-none focus:ring-0 px-0 placeholder-gray-700 mb-4">
                        <div class="grid grid-cols-2 gap-4 mb-4">
                            <select id="news-cat" class="bg-navy-900 border border-white/10 rounded-lg p-3 text-white text-sm outline-none"><option>ูุญููุงุช</option><option>ุงูุชุตุงุฏ</option></select>
                            <input type="text" id="news-img" placeholder="ุฑุงุจุท ุงูุตูุฑุฉ" class="bg-navy-900 border border-white/10 rounded-lg p-3 text-white text-sm outline-none">
                        </div>
                        <textarea id="editor" class="w-full h-40 bg-navy-900 border border-white/10 rounded-lg p-3 text-white text-sm outline-none mb-4" placeholder="ูุต ุงูุฎุจุฑ..."></textarea>
                        <div class="flex justify-between items-center">
                            <div class="flex gap-2">
                                <button class="text-xs bg-white/5 text-gold-400 px-3 py-1.5 rounded hover:bg-white/10"><i data-lucide="sparkles" class="inline w-3 h-3"></i> ุชุฏููู AI</button>
                            </div>
                            <button onclick="publishAction()" id="publish-btn" class="bg-gold-400 text-black px-6 py-2 rounded-lg font-bold hover:bg-white transition shadow-lg">ูุดุฑ ๐</button>
                        </div>
                    </div>
                    
                    <!-- Archive List -->
                    <div id="admin-list" class="space-y-2"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- Article Modal -->
    <div id="article-modal" class="view-hidden fixed inset-0 z-[80] bg-[#050510] overflow-y-auto animate-fade-in">
        <button onclick="closeArticleModal()" class="fixed top-6 left-6 z-50 bg-white/10 text-white p-2 rounded-full hover:bg-red-500 transition"><i data-lucide="x" class="w-6 h-6"></i></button>
        <div class="relative h-[40vh] w-full">
            <img id="modal-img" src="" class="w-full h-full object-cover">
            <div class="absolute inset-0 bg-gradient-to-t from-[#050510] to-transparent"></div>
            <div class="absolute bottom-0 right-0 p-8 w-full max-w-4xl mx-auto">
                <span id="modal-cat" class="bg-gold-400 text-black text-xs font-bold px-3 py-1 rounded-full"></span>
                <h1 id="modal-title" class="text-3xl md:text-5xl font-black text-white mt-2 drop-shadow-lg"></h1>
            </div>
        </div>
        <div class="max-w-3xl mx-auto px-6 py-12 prose prose-invert prose-lg prose-gold">
            <p id="modal-body"></p>
            <div class="mt-8 pt-8 border-t border-white/10 flex gap-4">
                <button class="flex items-center gap-2 text-green-500 hover:text-white"><i data-lucide="message-circle"></i> ูุงุชุณุงุจ</button>
                <button class="flex items-center gap-2 text-blue-400 hover:text-white"><i data-lucide="twitter"></i> ุชููุชุฑ</button>
            </div>
        </div>
    </div>

    <!-- Toast -->
    <div id="toast" class="fixed bottom-6 left-6 bg-green-600 text-white px-6 py-3 rounded-full shadow-2xl transform translate-y-24 opacity-0 transition-all duration-300 z-[100] font-bold">ุชู</div>

    <script>
        function initIcons() { if (window.lucide) lucide.createIcons(); }
        document.addEventListener('DOMContentLoaded', initIcons);

        // Firebase Config
        const firebaseConfig = { apiKey: "AIzaSyD7b1PZY26GN6hR2pliqiFRgyMsNyRlWOs", authDomain: "alhqyqa-62b0e.firebaseapp.com", projectId: "alhqyqa-62b0e", storageBucket: "alhqyqa-62b0e.firebasestorage.app", messagingSenderId: "354014970954", appId: "1:354014970954:web:435ca4eb0cbbfcfd1152b3" };
        
        let db, auth;
        const LOCAL_KEY = "alhqyq_news";

        try {
            firebase.initializeApp(firebaseConfig);
            db = firebase.firestore();
            auth = firebase.auth();
            
            auth.onAuthStateChanged(user => {
                if (user) {
                    document.getElementById('auth-modal').classList.add('view-hidden');
                    document.getElementById('dash-user-name').innerText = user.email || "ุนุถู";
                    // If admin, show dashboard link logic here
                }
                fetchNews();
            });
        } catch(e) { console.log("Offline Mode"); fetchNews(); }

        // --- Auth Logic ---
        function toggleAuthModal(tab = 'login') {
            const modal = document.getElementById('auth-modal');
            modal.classList.toggle('view-hidden');
            switchAuthTab(tab);
        }

        function switchAuthTab(tab) {
            document.getElementById('form-login').classList.add('hidden');
            document.getElementById('form-register').classList.add('hidden');
            document.getElementById('tab-login').className = "text-gray-500 hover:text-white pb-2 transition";
            document.getElementById('tab-register').className = "text-gray-500 hover:text-white pb-2 transition";
            
            document.getElementById(`form-${tab}`).classList.remove('hidden');
            document.getElementById(`tab-${tab}`).className = "text-gold-400 font-bold text-lg border-b-2 border-gold-400 pb-2";
        }

        async function handleLogin(e) {
            e.preventDefault();
            const email = document.getElementById('login-email').value;
            const pass = document.getElementById('login-password').value;
            try {
                await auth.signInWithEmailAndPassword(email, pass);
                toggleAuthModal();
                toggleDashboard(); // Open dashboard on login
            } catch(err) { alert("ุฎุทุฃ: " + err.message); }
        }

        async function handleRegister(e) {
            e.preventDefault();
            const email = document.getElementById('reg-email').value;
            const pass = document.getElementById('reg-password').value;
            const id = document.getElementById('reg-id').value;
            
            if(!id.startsWith('1') || id.length !== 10) return alert("ุฑูู ุงููููุฉ ุบูุฑ ุตุญูุญ");

            try {
                const res = await auth.createUserWithEmailAndPassword(email, pass);
                // Save user details in Firestore
                await db.collection('members').doc(res.user.uid).set({
                    name: document.getElementById('reg-name').value,
                    id: id,
                    region: document.getElementById('reg-region').value,
                    joined: new Date().toISOString()
                });
                alert("ุชู ุงูุชุณุฌูู ูุชูุซูู ุงูุนูุฏ ุจูุฌุงุญ โ");
                toggleAuthModal();
                toggleDashboard();
            } catch(err) { alert("ุฎุทุฃ: " + err.message); }
        }

        async function socialLogin(provider) {
            const p = new firebase.auth.GoogleAuthProvider();
            try {
                await auth.signInWithPopup(p);
                toggleAuthModal();
                toggleDashboard();
            } catch(err) { alert("ูุดู ุงูุฏุฎูู ุงูุงุฌุชูุงุนู: " + err.message); }
        }

        function toggleDashboard() {
            const dash = document.getElementById('dashboard-view');
            dash.classList.toggle('view-hidden');
            if(!dash.classList.contains('view-hidden')) loadAdminNews();
        }

        function logout() {
            auth.signOut();
            window.location.reload();
        }

        // --- News Logic ---
        async function fetchNews() {
            let news = [];
            try {
                const snap = await db.collection('news').limit(20).get();
                news = snap.docs.map(d => ({id: d.id, ...d.data()}));
            } catch {
                news = JSON.parse(localStorage.getItem(LOCAL_KEY) || "[]");
            }
            
            if(news.length === 0) news = [{id:1, title:"ุงูุทูุงู ุตุญููุฉ ุงูุญูููุฉ", category:"ุนุงู", img:"https://via.placeholder.com/800", desc:"ุจุฏุงูุฉ ุงูุนุตุฑ ุงูุฌุฏูุฏ...", date:"ุงูุขู"}];
            
            renderNews(news);
        }

        function renderNews(news) {
            const hero = news[0];
            const others = news.slice(1);
            
            document.getElementById('ticker-content').innerText = "ุงูุญูููุฉ | ุฃูู ุตุญููุฉ ุณุนูุฏูุฉ ุฑูููุฉ ุฐููุฉ | ุชุตููู ูุฅุดุฑุงู: ููุณู ุงูุนุชู โข " + news.map(n => n.title).join(" โข ");
            
            document.getElementById('hero-section').innerHTML = `
                <div onclick="openArticle('${hero.id}')" class="lg:col-span-12 relative group rounded-2xl overflow-hidden h-[400px] cursor-pointer shadow-2xl border border-white/10">
                    <img src="${hero.img}" class="w-full h-full object-cover transition duration-700 group-hover:scale-105">
                    <div class="absolute inset-0 bg-gradient-to-t from-black via-black/40 to-transparent"></div>
                    <div class="absolute bottom-0 p-10">
                        <span class="bg-gold-400 text-black text-xs font-bold px-3 py-1 rounded-full mb-3 inline-block">${hero.category}</span>
                        <h1 class="text-4xl font-black text-white mb-2">${hero.title}</h1>
                    </div>
                </div>`;
                
            document.getElementById('news-container').innerHTML = others.map(n => `
                <div onclick="openArticle('${n.id}')" class="flex gap-4 mb-4 bg-white/5 p-4 rounded-xl border border-white/5 hover:border-gold-400/30 cursor-pointer">
                    <div class="w-32 h-24 rounded-lg overflow-hidden"><img src="${n.img}" class="w-full h-full object-cover"></div>
                    <div class="flex-1"><h3 class="text-white font-bold line-clamp-2">${n.title}</h3><span class="text-xs text-gold-400 mt-2 block">${n.category}</span></div>
                </div>
            `).join('');
            initIcons();
            window.allNews = news;
        }

        // Admin News
        async function publishAction() {
            const btn = document.getElementById('publish-btn');
            btn.disabled = true; btn.innerText = "ุฌุงุฑู ุงููุดุฑ...";
            
            const article = {
                title: document.getElementById('news-title').value,
                category: document.getElementById('news-cat').value,
                img: document.getElementById('news-img').value || "https://via.placeholder.com/800",
                desc: document.getElementById('editor').value,
                date: new Date().toLocaleDateString('ar-SA'),
                timestamp: Date.now()
            };

            try {
                await db.collection('news').add(article);
                showToast("ุชู ุงููุดุฑ โ");
            } catch {
                const local = JSON.parse(localStorage.getItem(LOCAL_KEY) || "[]");
                local.unshift({...article, id: "loc_"+Date.now()});
                localStorage.setItem(LOCAL_KEY, JSON.stringify(local));
                showToast("ุชู ุงูุญูุธ ูุญููุงู โ๏ธ");
            }
            
            btn.disabled = false; btn.innerText = "ูุดุฑ ๐";
            document.getElementById('news-title').value = "";
            document.getElementById('editor').value = "";
            fetchNews(); loadAdminNews();
        }

        function loadAdminNews() {
             let news = window.allNews || [];
             document.getElementById('admin-list').innerHTML = news.map(n => `
                <div class="bg-white/5 p-3 rounded flex justify-between border-b border-white/5 text-gray-300">
                    <span class="truncate w-2/3">${n.title}</span>
                    <button class="text-red-400 hover:text-white"><i data-lucide="trash-2" class="w-4 h-4"></i></button>
                </div>
             `).join('');
             initIcons();
        }

        // Modal
        window.openArticle = (id) => {
            const art = window.allNews.find(n => n.id == id);
            if(!art) return;
            document.getElementById('modal-title').innerText = art.title;
            document.getElementById('modal-cat').innerText = art.category;
            document.getElementById('modal-img').src = art.img;
            document.getElementById('modal-body').innerHTML = marked.parse(art.desc);
            document.getElementById('article-modal').classList.remove('view-hidden');
        }
        window.closeArticleModal = () => document.getElementById('article-modal').classList.add('view-hidden');

        function showToast(msg) {
            const t = document.getElementById('toast');
            t.innerText = msg; t.classList.remove('translate-y-24', 'opacity-0');
            setTimeout(() => t.classList.add('translate-y-24', 'opacity-0'), 3000);
        }
    </script>
</body>
</html>


